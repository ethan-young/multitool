<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Check and Test your Blueprint • multitool</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Check and Test your Blueprint">
<script defer data-domain="ethan-young.github.io/multitool" src="https://plausible.io/js/script.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multitool</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/create-your-blueprint.html">Defining an Analysis Pipeline Blueprint</a></li>
    <li><a class="dropdown-item" href="../articles/validate-your-blueprint.html">Check and Test your Blueprint</a></li>
    <li><a class="dropdown-item" href="../articles/run-your-pipeline.html">Run your Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/multitool-nomenclature.html">multitool Nomenclature</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ethan-young/multitool/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Check and Test your Blueprint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ethan-young/multitool/blob/main/vignettes/validate-your-blueprint.Rmd" class="external-link"><code>vignettes/validate-your-blueprint.Rmd</code></a></small>
      <div class="d-none name"><code>validate-your-blueprint.Rmd</code></div>
    </div>

    
    
<p>Making an analysis pipeline blueprint is straightforward but it’s not
always immediately obvious how complex or large your decision pipeline
has become.</p>
<p>To help the user think through tweaking the blueprint, there are a
handful of functions to help you quickly print out some metadata about
your pipeline, such as how many total pipelines are there and how many
have to with filtering alternatives or variable versions.</p>
<p>First, we create our pipeline:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ethan-young.github.io/multitool/">multitool</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create some data</span></span>
<span><span class="va">the_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    id  <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,</span>
<span>    iv1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    iv2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    iv3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    mod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    dv1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    dv2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span>
<span>    include1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>    include2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, size <span class="op">=</span> <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    include3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># create a pipeline blueprint</span></span>
<span><span class="va">full_pipeline</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">the_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_filters.html">add_filters</a></span><span class="op">(</span><span class="va">include1</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">include2</span> <span class="op">!=</span> <span class="fl">3</span>, <span class="va">include3</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_variables.html">add_variables</a></span><span class="op">(</span>var_group <span class="op">=</span> <span class="st">"ivs"</span>, <span class="va">iv1</span>, <span class="va">iv2</span>, <span class="va">iv3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_variables.html">add_variables</a></span><span class="op">(</span>var_group <span class="op">=</span> <span class="st">"dvs"</span>, <span class="va">dv1</span>, <span class="va">dv2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_model.html">add_model</a></span><span class="op">(</span><span class="st">"linear model"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="op">{</span><span class="va">dvs</span><span class="op">}</span> <span class="op">~</span> <span class="op">{</span><span class="va">ivs</span><span class="op">}</span> <span class="op">*</span> <span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="blueprint-metadata">Blueprint metadata<a class="anchor" aria-label="anchor" href="#blueprint-metadata"></a>
</h2>
<p>There are a few <code>detect_*</code> functions for printing some
metadata about your pipeline.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of unique analysis pipelines</span></span>
<span><span class="fu"><a href="../reference/detect_multiverse_n.html">detect_multiverse_n</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 48</span></span>
<span></span>
<span><span class="co"># Number of different versions of analysis variables</span></span>
<span><span class="fu"><a href="../reference/detect_n_filters.html">detect_n_filters</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span></span>
<span><span class="co"># Number of unique filtering criteria</span></span>
<span><span class="fu"><a href="../reference/detect_n_filters.html">detect_n_filters</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span></span>
<span><span class="co"># Number of unique models</span></span>
<span><span class="fu"><a href="../reference/detect_n_models.html">detect_n_models</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>If you have several filtering decisions, you can also print a summary
of the sample sizes after each exclusion criteria is applied.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarize_filter_ns.html">summarize_filter_ns</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   filter_expression              variable n_retained n_excluded</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> include1 == 0                  include1        451         49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> include1 %in% unique(include1) include1        500          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> include2 != 3                  include2        345        155</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> include2 %in% unique(include2) include2        500          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> include3 &gt; -2.5                include3        496          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> include3 %in% unique(include3) include3        500          0</span></span></code></pre></div>
<p>Once you are satisfied with your pipeline metadata, you can expand it
and test it further. To do so, expand into a full decision grid.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expanded_pipeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_decisions.html">expand_decisions</a></span><span class="op">(</span><span class="va">full_pipeline</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="test-your-blueprint">Test your blueprint<a class="anchor" aria-label="anchor" href="#test-your-blueprint"></a>
</h2>
<p>A <code>multitool</code> specification blueprint has a special
feature: it captures your code and generates analysis pipelines.</p>
<p>A special set of functions with the <code>show_code_*</code> prefix
allow you to see the code that will be executed for a single pipeline.
For example, we can look at our filtering code for the first decision of
our blueprint:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take a look at the first filter decision</span></span>
<span><span class="va">expanded_pipeline</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/show_code_subgroups.html">show_code_filter</a></span><span class="op">(</span>decision_num <span class="op">=</span> <span class="fl">1</span>, console <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; the_data |&gt; </span></span>
<span><span class="co">#&gt;   filter(include1 == 0, include2 != 3, include3 &gt; -2.5)</span></span></code></pre></div>
<p>These functions allow you to generate the relevant code along the
analysis pipeline. For example, we can look at our model pipeline for
decision 17 using <code>show_code_model(decision_num = 17)</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expanded_pipeline</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/show_code_subgroups.html">show_code_model</a></span><span class="op">(</span>decision_num <span class="op">=</span> <span class="fl">17</span>, console <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; the_data |&gt; </span></span>
<span><span class="co">#&gt;   filter(include1 == 0, include2 %in% unique(include2), include3 &gt; -2.5) |&gt; </span></span>
<span><span class="co">#&gt;   lm(dv1 ~ iv3 * mod, data = _)</span></span></code></pre></div>
<p>Setting the <code>copy</code> argument to <code>TRUE</code> allows
you to send the code straight to your clipboard. You can paste it into
the source or console for testing/editing.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ethan Young, Stefan Vermeent.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
